<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Message Translation</title>
    <link href="hjb_v1.css" type="text/css" rel="stylesheet">
    </link>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    </meta>
<meta content="Docutils 0.3.7: http://docutils.sourceforge.net/" name="generator">
</meta>
  </head>
  <body align="center">
    <div class="outer-body">
    <div class="hjb-title">
      <h2 class="hjb-title">HJB (HTTP JMS Bridge)</h2>
     </div>
   <div class="navigation-bar">
     <table align="center" class="navigation-bar">
       <tbody>
	 <tr>
	   <td>
	   <a href="index.html">Home</a></td>
	   <td>
	   <a href="download.html">Download</a></td>
	   <td>
	   <a href="doc.html">Documentation</a></td>
	   <td>
	   <a href="detailed-design.html">Design</a></td>
	   <td>
	   <a href="mailto:users@hjb.tigris.org">Support</a></td>
	 </tr>
       </tbody>
     </table>
   </div>
   
   <div>
    
     <div class="inner-body">
      <h2>Message Translation</h2>
      <div class="section" id="jms-message-types">
<h2>
<a name="jms-message-types">JMS Message Types</a></h2>
<p>The JMS API supports 5 message types, all of which can be sent and
received by HJB.  They are:</p>
<ul class="simple">
<li>
<a href="#text-message" class="reference">Text Message</a></li>
<li>
<a href="#object-message" class="reference">Object Message</a></li>
<li>
<a href="#bytes-message" class="reference">Bytes Message</a></li>
<li>
<a href="#map-message" class="reference">Map Message</a></li>
<li>
<a href="#stream-message" class="reference">Stream Message</a></li>
</ul>
<p>Please refer to <a href="#jmsspec" id="id1" name="id1" class="citation-reference">[JMSSpec]</a> for full descriptions of each these message
types.</p>
<p>HJB clients can send or receive textual representations of any of
these message types.  When sent, the message is contained in the
parameters of a the sending POST request.  When received, the message
is part of the body of a HTTP response.</p>
<p>The following sections describe how the parts of each of these JMS
message types is transformed into text in a HTTP request or response.</p>
</div>
<div class="section" id="common-features">
<h2>
<a name="common-features">Common features</a></h2>
<p>All JMS messages have a fixed set of standard header fields, which JMS
represents as typed attributes on the JMS message class. In addition,
they may optionally have application-specific message properties (see
<a href="#jmsspec" id="id2" name="id2" class="citation-reference">[JMSSpec]</a> for a full description).</p>
<p>HJB allows all these values to be transferred in a simple, consistent
fashion.</p>
<ul>
<li>
<p class="first">The header fields are mapped to specific parameter names in a HTTP
POST request and to field-assignment lines in a HTTP response.  The
JMS attributes and their corresponding HJB field names are:</p>
<table border="1" class="display-items docutils">
<colgroup>
<col width="38%">
</col>
<col width="62%">
</col>
</colgroup>
<thead valign="bottom">
<tr>
<th>
<p class="first last">Attribute Name</p>
</th>
<th>
<p class="first last">HJB field name</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td>
<p class="first last">JMSType</p>
</td>
<td>
<p class="first last">hjb.core.jms.type</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSReplyTo</p>
</td>
<td>
<p class="first last">hjb.core.jms.replyTo</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSRedelivered</p>
</td>
<td>
<p class="first last">hjb.core.jms.redelivered</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSPriority</p>
</td>
<td>
<p class="first last">hjb.core.jms.priority</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSMessageID</p>
</td>
<td>
<p class="first last">hjb.core.jms.messageId</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSDestination</p>
</td>
<td>
<p class="first last">hjb.core.jms.destination</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSExpiration</p>
</td>
<td>
<p class="first last">hjb.core.jms.expiration</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSTimestamp</p>
</td>
<td>
<p class="first last">hjb.core.jms.timestamp</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSDeliveryMode</p>
</td>
<td>
<p class="first last">hjb.core.jms.deliveryMode</p>
</td>
</tr>
<tr>
<td>
<p class="first last">JMSCorrelationID</p>
</td>
<td>
<p class="first last">hjb.core.jms.correlationId</p>
</td>
</tr>
</tbody>
</table>
</li>
<li>
<p class="first">The optional application-specific properties are mapped in the same
way.  They are additional parameters in the HTTP POST request when
sending a message, and 'field-assignment' lines in a HTTP response.
No special transformation is required of the application property
names.</p>
</li>
<li>
<p class="first">The Java type of the message attributes and properties is preserved
by ensuring that the values are <a href="./codec.rst" class="reference">HJB-encoded</a>.</p>
</li>
<li>
<p class="first">If a message attribute is encoded as the wrong type, it is ignored.</p>
</li>
<li>
<p class="first">When sending messages, HJB clients <em>must</em> put attribute values and
application-specific properties in the HTTP POST request as HTTP
form-encoded parameters whose values are <a href="./codec.rst" class="reference">HJB-encoded</a>. HJB decodes
the parameters, places them into a real JMS message, then sends
it.</p>
</li>
<li>
<p class="first">On receiving messages, the JMS message attributes, its optional
properties and the mmessage body are all included in the response as
text. The message attributes and properties are <strong>not</strong> mapped to
HTTP response headers.  The message attributes, properties and the
actual returned message are organised in a simple textual format, as
follows:</p>
<ul>
<li>
<p class="first">The message is in two sections. The message attributes and
properties form the first section of the output, the body of the
message forms the other section. The two sections are separated by
a</p>
<p>%&lt;CR></p>
<p>where &lt;CR> is a platform specific line separator.</p>
</li>
<li>
<p class="first">The message attributes and optional properties are placed on
sequential lines. Each line consists of</p>
<p>name=value</p>
<p>where 'name' is the property/attribute name and 'value' is its
value.</p>
</li>
<li>
<p class="first">The body of the message depends on the message type. These are
described in section.</p>
</li>
</ul>
</li>
<li>
<p class="first">On receiving multiple messages, e.g., in the HTTP response of
viewing a queue of messages, each message is returned in the same
format as described above, with each one separated from the next by</p>
<p>%%&lt;CR></p>
</li>
<li>
<p class="first">When sending messages, HJB clients also send the message body as a
form-encoded parameter, named</p>
<p>
<em>message-to-send</em></p>
</li>
<li>
<p class="first">On both sending and receiving, the HJB message <strong>must</strong> include a
specific named parameter (or field-assignment line) containing the
JMS class the HJB message represents.</p>
<ul class="simple">
<li>The name of this required field is <em>hjb.core.jms-message-class</em></li>
<li>Its value <strong>must</strong> be the name of the JMS interface class that the
message represents. I.e., it should be one of:<ul>
<li>javax.jms.TextMessage</li>
<li>javax.jms.ObjectMessage</li>
<li>javax.jms.StreamMessage</li>
<li>javax.jms.MapMessage</li>
<li>javax.jmx.BytesMessage</li>
</ul>
</li>
</ul>
</li>
<li>
<p class="first">On both sending and receiving, the HJB message <strong>must</strong> include a
specific name parameter (or field) that contains the version of the
HJB message.</p>
<ul class="simple">
<li>the field's name is <em>hjb.core.version</em></li>
<li>the field's value for HJB messages as defined in this document is
<em>1.0</em></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="message-bodies">
<h2>
<a name="message-bodies">Message Bodies</a></h2>
<p>The different message types have different textual representations for
their message bodies; these are described in the following sections.</p>
</div>
<div class="message-desc section" id="text-message">
<h2>
<a name="text-message">Text Message</a></h2>
<ul class="simple">
<li>The body of the message is sent as the raw text contained in the
message.  This makes TextMessage the simplest message to process!
N.B., TextMessages are probably the most widely used JMS message as
they allow transmission of XML.</li>
<li>The value of the field 'hjb.core.jms-message-class' is<ul>
<li>javax.jms.TextMessage</li>
</ul>
</li>
</ul>
</div>
<div class="message-desc section" id="object-message">
<h2>
<a name="object-message">Object Message</a></h2>
<ul class="simple">
<li>The body of the message is the text derived from encoding the byte
array representation of the java object contained in the Object
Message.  The byte array is encoded using Base64 encoding. The
resulting encoded message is in the S-Expression form HJB uses to
represent byte arrays.</li>
<li>The value of the field 'hjb.core.jms-message-class' is<ul>
<li>javax.jms.ObjectMessage</li>
</ul>
</li>
</ul>
</div>
<div class="message-desc section" id="bytes-message">
<h2>
<a name="bytes-message">Bytes Message</a></h2>
<ul class="simple">
<li>The body of the message is the text derived from treating the entire
Bytes message content as a single byte array, and encoding it using
Base64 encoding.  The resulting encoded message text is in the
S-Expression form HJB uses to represent byte arrays.</li>
<li>The value of the field 'hjb.core.jms-message-class' is<ul>
<li>javax.jms.BytesMessage</li>
</ul>
</li>
</ul>
</div>
<div class="message-desc section" id="map-message">
<h2>
<a name="map-message">Map Message</a></h2>
<ul>
<li>
<p class="first">The body of the message consists of a line for each name in the
MapMessage. Each line is as follows:</p>
<ul class="simple">
<li>name=value&lt;CR></li>
</ul>
<p>where &lt;CR> is a platform specific line separator.  The map
values are represented in exactly the same as the way message
headers are written.</p>
</li>
<li>
<p class="first">The value of the field 'hjb.core.jms-message-class' is</p>
<ul class="simple">
<li>javax.jms.MapMessage</li>
</ul>
</li>
</ul>
</div>
<div class="message-desc section" id="stream-message">
<h2>
<a name="stream-message">Stream Message</a></h2>
<ul class="simple">
<li>The body of the message consists of a line for each value read from
or written to the Stream Message.  Each line contains an index and
an encoded value.  The encoded value is some data that is an actual
part of the Stream Message.  The index represents the order in which
its corresponding value was read from the message (on receiving) or
the order in which it should be written to the message (on
sending). Each line is as follows:<ul>
<li>index=value</li>
</ul>
</li>
<li>The value of the header field 'hjb.core.jms-message-class' is<ul>
<li>javax.jms.StreamMessage</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="links">
<h2>
<a name="links">Links</a></h2>
<table rules="none" frame="void" class="docutils footnote" id="id3">
<colgroup>
<col class="label">
</col>
<col>
</col>
</colgroup>
<tbody valign="top">
<tr>
<td class="label">
<a name="id3">[1]</a></td><td><a href="http://en.wikipedia.org/wiki/Base64" class="reference">Base64 encoding</a></td></tr>
</tbody>
</table>
<table rules="none" frame="void" class="docutils citation" id="jmsspec">
<colgroup>
<col class="label">
</col>
<col>
</col>
</colgroup>
<tbody valign="top">
<tr>
<td class="label">
<a name="jmsspec">[JMSSpec]</a></td><td><em>(<a href="#id1" class="fn-backref">1</a>, <a href="#id2" class="fn-backref">2</a>)</em> <a href="http://java.sun.com/products/jms/docs.html" class="reference">Java Message Service specification 1.1</a></td></tr>
</tbody>
</table>
</div>
      <hr class="docutils footer">
      </hr>
<div class="footer">
<a href="message-translation.rst" class="reference">View document source</a>.
Generated by <a href="http://docutils.sourceforge.net/" class="reference">Docutils</a> from <a href="http://docutils.sourceforge.net/rst.html" class="reference">reStructuredText</a> source.
</div>
    </div>
  </div>
   </div>
   
  </body>
</html>